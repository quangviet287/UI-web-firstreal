<!DOCTYPE html>
<html class="no-js"> 
    <head lang="vi">
       <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>FIRST REAL | Giao dịch</title>
        <meta name="description" content="First Real">
        <meta name="author" content="Khoá Luận">
        <meta name="keyword" content="First Real">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300,700,800' rel='stylesheet' type='text/css'>

        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
        <link rel="shortcut icon" href="assets/img/favicon.png" type="image/x-icon">
        <link rel="icon" href="assets/img/favicon.png" type="image/x-icon">

        <link rel="stylesheet" href="assets/css/normalize.css">
        <link rel="stylesheet" href="assets/css/font-awesome.min.css">
        <link rel="stylesheet" href="assets/css/fontello.css">
        <link href="assets/fonts/icon-7-stroke/css/pe-icon-7-stroke.css" rel="stylesheet">
        <link href="assets/fonts/icon-7-stroke/css/helper.css" rel="stylesheet">
        <link href="assets/css/animate.css" rel="stylesheet" media="screen">
        <link rel="stylesheet" href="assets/css/bootstrap-select.min.css">
        <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
        <link rel="stylesheet" href="assets/css/icheck.min_all.css">
        <link rel="stylesheet" href="assets/css/price-range.css">
        <link rel="stylesheet" href="assets/css/owl.carousel.css">
        <link rel="stylesheet" href="assets/css/owl.theme.css">
        <link rel="stylesheet" href="assets/css/owl.transitions.css">
        <link rel="stylesheet" href="assets/css/style.css">
        <link rel="stylesheet" href="assets/css/responsive.css">
        <link rel="shortcut icon" type="image/png" href="assets/img/favicon.png"/>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <link rel='stylesheet' href='https://cdn.rawgit.com/t4t5/sweetalert/v0.2.0/lib/sweet-alert.css'>
<script src='https://cdn.rawgit.com/t4t5/sweetalert/v0.2.0/lib/sweet-alert.min.js'></script>

        <style type="text/css">
            /*--bottom-to-top --*/
            #toTop {
                display: none;
                text-decoration: none;
                position: fixed;
                bottom: 24px;
                right: 1%;
                overflow: hidden;
                z-index: 999; 
                width: 64px;
                height: 64px;
                border: none;
                text-indent: 100%;
                background: url("assets/img/arrow_top.png") no-repeat 0px 0px;
            }
            #toTopHover {
                width: 64px;
                height: 64px;
                display: block;
                overflow: hidden;
                float: right;
                opacity: 0;
                -moz-opacity: 0;
                filter: alpha(opacity=0);
            }
            /*-- //bottom-to-top --*/
        </style>
    </head>
    <body>

        <div id="preloader">
            <div id="status">&nbsp;</div>
        </div>
        <!-- Body content -->

        <div class="header-connect">
            <div class="container">
                <div class="row">
                    <div class="col-md-5 col-sm-8  col-xs-12">
                        <div class="header-half header-call">
                            <p>
                                <span><i class="pe-7s-call"></i> (+84) 2363 616 767 </span>
                                <span><i class="pe-7s-mail"></i> hotro@firstreal.com.vn</span>
                            </p>
                        </div>
                    </div>

                </div>
            </div>
        </div>
        <!--End top header -->

        <nav class="navbar navbar-default ">
            <div class="container">
                <!-- Brand and toggle get grouped for better mobile display -->
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navigation">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="index.html"><img src="assets/img/logo1.png" alt=""></a>
                </div>

                <!-- Collect the nav links, forms, and other content for toggling -->
                <div class="collapse navbar-collapse yamm" id="navigation">
                    <!-- <div id="Welcome" class="button navbar-right">
                      
                    </div> -->

                    <ul class="main-nav nav navbar-nav navbar-right">

                        <li class="wow fadeInDown" data-wow-delay="0.1s" >
                            <a href="index.html" class="dropdown-toggle active" >Trang Chủ </a>
                        </li>
                        <li class="wow fadeInDown" data-wow-delay="0.3s"><a class="" href="about.html">Giới Thiệu    </a></li>
                        <li class="dropdown ymm-sw " data-wow-delay="0.1s">
                            <a href="index.html"  data-toggle="dropdown" data-hover="dropdown" data-delay="200">Dự Án    <b class="caret"></b></a>
                            <ul class="dropdown-menu navbar-nav">
                                <li>
                                    <a href="properties.html">Đất nền </a>
                                </li>
                                <li>
                                    <a href="properties-2.html">Căn hộ </a>
                                </li>
                                <li>
                                    <a href="properties-3.html">Nhà ở </a>
                                </li>
                                <li>
                                    <a href="properties-3.html">Biệt thự </a>
                                </li>
                                <li>
                                    <a href="properties-3.html">Officetel (Office+Hotel)  </a>
                                </li>

                            </ul>
                        </li>
                        <li class="wow fadeInDown" data-wow-delay="0.5s"><a href="contact.html">Liên Hệ</a></li>
                        <li id="statistical" class="wow fadeInDown" data-wow-delay="0.5s"></li>
                        <li id="Welcome" class="wow fadeInDown" data-wow-delay="0.1s" >
                        </li>
                    </ul>
                </div><!-- /.navbar-collapse -->
            </div><!-- /.container-fluid -->
        </nav>
        <!-- End of nav bar -->

        <div class="page-head">
            <div class="container">
                <div class="row">
                    <div class="page-head-content">
                        <h1 class="page-title">Thông Tin Khách Hàng </h1>
                    </div>
                </div>
            </div>
        </div>
        <!-- End page header -->

        <!-- property area -->
        <div class="content-area recent-property padding-top-40" style="background-color: #FFF;">
            <div class="container">
                <div class="row">
                    <div class="col-md-8 col-md-offset-2">
                        <div class="" id="contact1">
                            
                            <form id="formCustomer">
                                <div class="row">
                                    
                                    <div class="col-sm-12">
                                        <div class="form-group">
                                            <label for="lastname">Tên khách hàng</label>
                                            <input type="text" class="form-control" name="customerName" required minlength="3" maxlength="20">
                                        </div>
                                    </div>
                                   
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label for="subject">Tuổi </label>
                                            <input type="number" class="form-control" name="age" required  pattern="[0-9]{2}" title="Yêu cầu nhập số " >
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div id="projectDetailId" class="form-group">
                                            <!-- <input type="hidden" class="form-control" name="projectDetailId" value="projectDetailId" required  pattern="[0-9]{2}" title="Yêu cầu nhập số " > -->
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label for="email">Số điện thoại</label>
                                            <input type="number" class="form-control" name="phoneNumber" required pattern="[0-9]{6-15}" title="Yêu cầu nhập số và tối thiểu 6 ký tự"  >
                                        </div>
                                    </div>
                                     <div class="col-sm-6">
                                        <div class="form-group">
                                            <label for="email">Giới tính</label> <br>
                                            <input type="radio" name="sex" value="true" checked=""> Nam
                                            <input type="radio" name="sex" value="false"> Nữ
                                        </div>
                                    </div>
                                    <div id="buttonConfirm" class="col-sm-12 text-center">
                                        <!-- <button type="button" onclick="submitFormCustomer();" data-book-id="'+employees.employeeId+'" class="btn btn-primary" data-toggle="modal" href="#deleteEmployeeModal"><i class="fa fa-envelope-o"></i> Tiếp tục</button> -->
                                    </div>
                                </div>
                                <!-- /.row -->
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
    <div id="deleteEmployeeModal" class="modal fade">
        <div class="modal-dialog">
            <div class="modal-content">
                <form id="confirmTransaction">
                    <div class="modal-header">
                        <h4 class="modal-title">Xác Nhận Giao Dịch</h4>
                    </div>
                    <div class="modal-body">
                        <p>Bạn có chắc chắn muốn thực hiện giao dịch này?</p>
                        <input type="text" name="bookId" value="" type="hidden" disabled/>
                    </div>
                    <div class="modal-footer">
                        <input type="button" class="btn btn-default" data-dismiss="modal" value="Huỷ bỏ"><br><br>
                        <input type="button" data-dismiss="modal" onclick="confirm();" class="btn btn-default" value="Xác Nhận Giao Dịch">
                    </div>
                </form>
            </div>
        </div>
    </div>
  
        <script src="assets/js/modernizr-2.6.2.min.js"></script>

        <script src="assets/js/jquery-1.10.2.min.js"></script>
        <script src="bootstrap/js/bootstrap.min.js"></script>
        <script src="assets/js/bootstrap-select.min.js"></script>
        <script src="assets/js/bootstrap-hover-dropdown.js"></script>

        <script src="assets/js/easypiechart.min.js"></script>
        <script src="assets/js/jquery.easypiechart.min.js"></script>

        <script src="assets/js/owl.carousel.min.js"></script>
        <script src="assets/js/wow.js"></script>

        <script src="assets/js/icheck.min.js"></script>
        <script src="assets/js/price-range.js"></script>

        
        
        

        <script src="assets/js/main.js"></script>

        <!-- Slide-To-Top JavaScript (No-Need-To-Change) -->
        <script type="text/javascript">
            $(document).ready(function() {
                var defaults = {
                    containerID: 'toTop', // fading element id
                    containerHoverID: 'toTopHover', // fading element hover id
                    scrollSpeed: 100,
                    easingType: 'linear'
                };
                loadName();
                loadProjectDetailId();
            });
            function getUrlVar(key){
                var result = new RegExp(key + "=([^&]*)", "i").exec(window.location.search); 
                return result && unescape(result[1]) || ""; 
            }
            function loadName(){
                var employeeName = getUrlVar('username');
                //alert(employeeName);
                var item=(
                        '<a href="#" class="dropdown-toggle active">Welcome, '+employeeName+'</a>'
                    );
                $("#Welcome").append(item); 

                var statistical = ('<a href="NhanVienThongKe.html?employeeName='+employeeName+'">Thống Kê Giao Dịch</a>');
                $("#statistical").append(statistical);
            }
            function submitFormCustomer(){
                var projectDetailId =getUrlVar('projectDetailId');
                var formData = new FormData(document.getElementById('formCustomer'));
                var data=
                    JSON.stringify({
                    customerName: formData.get("customerName"),
                    sex: formData.get("sex"),
                    age: formData.get("age"),
                    phoneNumber: formData.get("phoneNumber")
                    });
                console.log(data);
                $.ajax({
                    type: "post",
                    url: "http://localhost:8080/transaction/save/"+projectDetailId,
                    contentType: "application/json",
                    //dataType: "json",
                    data:data
                    // success: function(response){
                    //             console.log(response);
                    //         },
                    // error: function(response){
                    //     location.reload();
                    // }
                }).done(function (response){
                            swal("Good job!", "Tạo Thông Tin Khách Hàng Thành Công!", "success");
                })
            }
            function loadProjectDetailId(){
                var projectDetailId =getUrlVar('projectDetailId');
                console.log(projectDetailId);
                var item = (
                    '<input type="hidden" class="form-control" name="projectDetailId" value="'+projectDetailId+'">'
                );
                $("#projectDetailId").append(item); 

                var btnConfirm = (
                    '<button type="button" onclick="submitFormCustomer();" data-book-id="'+projectDetailId+'" class="btn btn-primary" data-toggle="modal" href="#deleteEmployeeModal"><i class="fa fa-envelope-o"></i> Tiếp tục</button>'
                );
                $("#buttonConfirm").append(btnConfirm);

                $('#deleteEmployeeModal').on('show.bs.modal', function(e) {
                    var bookId = $(e.relatedTarget).data('book-id');
                    $(e.currentTarget).find('input[name="bookId"]').val(bookId);
                });
            }
            function confirm() {
                var formData = document.getElementById("confirmTransaction");
                var projectDetailId = formData.elements["bookId"].value;
                $.ajax({
                        type: "PUT",
                        url: "http://localhost:8080/transaction/finish/"+projectDetailId,
                        contentType: "application/json",
                        success: function(response){
                                    //console.log(response);
                                   swal("Good job!", "Tạo Thông Giao Dịch Thành Công!", "success");
                                    location.reload();
                                    //window.location.reload('customer.html');
                                },
                        error: function(response){
                            swal("Oops...", "Tạo Giao Dịch  Thất Bại!", "error");
                            //location.reload();
                        }
                    });
            }
        </script>
        <a href="#" id="toTop" style="display: block;"> <span id="toTopHover" style="opacity: 0;"> </span></a>
        <!-- //Slide-To-Top JavaScript -->

    </body>
</html>
